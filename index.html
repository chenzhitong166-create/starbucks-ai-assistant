<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æ˜Ÿå·´å…‹é—¨åº—æ™ºèƒ½åŠ©æ‰‹ - AIæ“ä½œæŒ‡å—å’¨è¯¢ç³»ç»Ÿ</title>
<meta name="description" content="åŸºäºAIçš„æ˜Ÿå·´å…‹é—¨åº—æ“ä½œæŒ‡å—æ™ºèƒ½é—®ç­”ç³»ç»Ÿ">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
    --starbucks-green: #006241;
    --starbucks-light-green: #00a862;
    --accent-gold: #d4af37;
}
* { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI', 'Microsoft YaHei', system-ui, sans-serif; }
body { background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); min-height:100vh; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:20px; color:#333; }
.container { width:100%; max-width:1000px; background:white; border-radius:24px; box-shadow:0 20px 60px rgba(0,98,65,0.15); overflow:hidden; border:1px solid rgba(0,98,65,0.1); margin:20px auto; }
.header { background: linear-gradient(135deg, var(--starbucks-green) 0%, var(--starbucks-light-green) 100%); color:white; padding:40px 30px; text-align:center; position:relative; overflow:hidden; }
.header::before { content:"â˜•"; position:absolute; font-size:120px; opacity:0.1; right:30px; top:20px; }
.logo { font-size:60px; margin-bottom:20px; animation: float 3s ease-in-out infinite; }
@keyframes float { 0%,100% { transform:translateY(0); } 50% { transform:translateY(-10px); } }
.title { font-size:36px; font-weight:700; margin-bottom:10px; letter-spacing:-0.5px; }
.subtitle { font-size:18px; opacity:0.9; max-width:600px; margin:0 auto; line-height:1.5; }
.features { display:grid; grid-template-columns:repeat(auto-fit, minmax(220px, 1fr)); gap:20px; padding:40px 30px; background:#f8f9fa; }
.feature { background:white; padding:25px; border-radius:16px; text-align:center; box-shadow:0 5px 15px rgba(0,0,0,0.05); transition: transform 0.3s ease, box-shadow 0.3s ease; border:1px solid #eee; }
.feature:hover { transform:translateY(-5px); box-shadow:0 10px 25px rgba(0,98,65,0.1); }
.feature-icon { font-size:40px; color:var(--starbucks-green); margin-bottom:15px; }
.feature-title { font-size:18px; font-weight:600; margin-bottom:10px; color:#2c3e50; }
.feature-desc { font-size:14px; color:#666; line-height:1.5; }
.chat-section { padding:30px; }
.chat-header { display:flex; align-items:center; margin-bottom:20px; padding-bottom:15px; border-bottom:2px solid #f0f0f0; }
.chat-title { font-size:24px; font-weight:600; color:var(--starbucks-green); margin-left:15px; }
.chat-box { width:100%; height:400px; border:1px solid #e0e0e0; border-radius:12px; padding:10px; overflow-y:auto; background:#fafafa; margin-bottom:10px; }
#chatInput { width:70%; padding:10px; font-size:16px; border-radius:6px; border:1px solid #ccc; }
#sendBtn { padding:10px 20px; font-size:16px; border:none; border-radius:6px; background:var(--starbucks-green); color:white; cursor:pointer; margin-left:10px; }
#sendBtn:hover { background:var(--starbucks-light-green); }
.instructions { background:#fff8e1; border-left:4px solid var(--accent-gold); padding:20px; margin:30px 0; border-radius:8px; font-size:15px; }
.footer { text-align:center; padding:25px; color:#666; font-size:14px; border-top:1px solid #eee; background:#f8f9fa; }
.tech-badges { display:flex; justify-content:center; gap:10px; margin-top:15px; flex-wrap:wrap; }
.badge { background:#e8f5e9; color:var(--starbucks-green); padding:6px 12px; border-radius:20px; font-size:12px; font-weight:500; }
.user { color:var(--starbucks-green); margin:5px 0; font-weight:600; }
.assistant { color:#333; margin:5px 0; padding:10px; background:#f8f9fa; border-radius:8px; border-left:3px solid var(--starbucks-light-green); }
.thinking { color:#666; font-style:italic; }
.error { color:#d32f2f; background:#ffebee; padding:10px; border-radius:8px; border-left:3px solid #d32f2f; }
@media (max-width:768px) {
    .features { grid-template-columns:1fr; padding:30px 20px; }
    .chat-box { height:300px; }
    #chatInput { width:65%; }
}
</style>
</head>
<body>
<div class="container">
  <!-- å¤´éƒ¨ -->
  <div class="header">
    <div class="logo">â˜•</div>
    <h1 class="title">æ˜Ÿå·´å…‹é—¨åº—æ™ºèƒ½åŠ©æ‰‹</h1>
    <p class="subtitle">åŸºäºAIæŠ€æœ¯çš„é—¨åº—æ“ä½œæŒ‡å—æ™ºèƒ½é—®ç­”ç³»ç»Ÿ Â· ä¸“ä¸šè§£ç­” Â· å¿«é€Ÿå“åº”</p>
  </div>

  <!-- åŠŸèƒ½ç‰¹è‰² -->
  <div class="features">
    <div class="feature"><div class="feature-icon">ğŸ¤–</div><h3 class="feature-title">AIæ™ºèƒ½åˆ†æ</h3><p class="feature-desc">åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼Œæ™ºèƒ½ç†è§£å¹¶è§£ç­”æ“ä½œæ‰‹å†Œç›¸å…³é—®é¢˜</p></div>
    <div class="feature"><div class="feature-icon">âš¡</div><h3 class="feature-title">å³æ—¶å“åº”</h3><p class="feature-desc">7x24å°æ—¶åœ¨çº¿ï¼Œç§’çº§å“åº”æ‚¨çš„æŸ¥è¯¢è¯·æ±‚</p></div>
    <div class="feature"><div class="feature-icon">ğŸ“š</div><h3 class="feature-title">çŸ¥è¯†åº“æ”¯æŒ</h3><p class="feature-desc">åŸºäºæ˜Ÿå·´å…‹å®˜æ–¹æ“ä½œæ‰‹å†Œï¼Œç¡®ä¿ä¿¡æ¯å‡†ç¡®å¯é </p></div>
    <div class="feature"><div class="feature-icon">ğŸ”’</div><h3 class="feature-title">å®‰å…¨å¯é </h3><p class="feature-desc">ä¼ä¸šçº§å®‰å…¨é˜²æŠ¤ï¼Œä¿éšœæ‚¨çš„æ•°æ®éšç§</p></div>
  </div>

  <!-- ä½¿ç”¨è¯´æ˜ -->
  <div class="instructions">
    <strong>ğŸ’¡ ä½¿ç”¨è¯´æ˜ï¼š</strong> è¿™æ˜¯ä¸€ä¸ªåŸºäºRAGï¼ˆæ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æŠ€æœ¯çš„AIåŠ©æ‰‹ã€‚æˆ‘å·²ä¸Šä¼ äº†æ˜Ÿå·´å…‹æ“ä½œæ‰‹å†Œï¼Œæ‚¨å¯ä»¥ç›´æ¥è¯¢é—®å…³äºé—¨åº—è¿è¥ã€äº§å“æ ‡å‡†ã€å·¥ä½œæµç¨‹ç­‰ç›¸å…³é—®é¢˜ã€‚
  </div>

  <!-- èŠå¤©ç•Œé¢ -->
  <div class="chat-section">
    <div class="chat-header"><div style="font-size:32px;">ğŸ’¬</div><div class="chat-title">å¼€å§‹å’¨è¯¢</div></div>
    <div class="chat-box" id="chatBox">
      <div class="assistant">æ‚¨å¥½ï¼æˆ‘æ˜¯æ˜Ÿå·´å…‹é—¨åº—æ™ºèƒ½åŠ©æ‰‹ã€‚è¯·é—®æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ</div>
    </div>
    <input type="text" id="chatInput" placeholder="è¾“å…¥ä½ çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼šå†°ç¾å¼æ€ä¹ˆåšï¼Ÿ"/>
    <button id="sendBtn">å‘é€</button>
  </div>

  <!-- åº•éƒ¨ -->
  <div class="footer">
    <p>æ˜Ÿå·´å…‹é—¨åº—æ™ºèƒ½åŠ©æ‰‹æ¼”ç¤ºç³»ç»Ÿ | åŸºäºn8n + Google Gemini + Pineconeæ„å»º</p>
    <div class="tech-badges">
      <span class="badge">n8nå·¥ä½œæµè‡ªåŠ¨åŒ–</span>
      <span class="badge">Google Gemini AI</span>
      <span class="badge">Pineconeå‘é‡æ•°æ®åº“</span>
      <span class="badge">RAGæ£€ç´¢å¢å¼º</span>
      <span class="badge">GitHub Pageséƒ¨ç½²</span>
    </div>
    <p style="margin-top:15px; font-size:13px; color:#888;">è¿™æ˜¯ä¸€ä¸ªæŠ€æœ¯æ¼”ç¤ºé¡¹ç›®ï¼Œå±•ç¤ºäº†AIåœ¨å·¥ä½œæµç¨‹è‡ªåŠ¨åŒ–å’ŒçŸ¥è¯†ç®¡ç†ä¸­çš„åº”ç”¨</p>
  </div>
</div>

<script>
const WEBHOOK_URL = "https://chenzhitong.app.n8n.cloud/webhook/starbucks-ai-assistant";
const chatInput = document.getElementById("chatInput");
const sendBtn = document.getElementById("sendBtn");
const chatBox = document.getElementById("chatBox");

// æ˜¾ç¤ºæ¶ˆæ¯å‡½æ•°
function addMessage(text, sender, type = "normal") {
  const div = document.createElement("div");
  div.className = sender;
  
  if (type === "thinking") {
    div.className = "thinking";
    div.textContent = "AI: æ€è€ƒä¸­...";
  } else if (type === "error") {
    div.className = "error";
    div.textContent = "AI: " + text;
  } else {
    div.textContent = (sender === "user" ? "æˆ‘: " : "AI: ") + text;
  }
  
  chatBox.appendChild(div);
  chatBox.scrollTop = chatBox.scrollHeight;
  return div;
}

// æ›´æ–°æ¶ˆæ¯å†…å®¹
function updateMessage(element, text, sender = "assistant") {
  element.className = sender;
  element.textContent = (sender === "user" ? "æˆ‘: " : "AI: ") + text;
}

// å‘é€æ¶ˆæ¯å‡½æ•°
async function sendMessage() {
  const text = chatInput.value.trim();
  if (!text) return;
  
  // æ˜¾ç¤ºç”¨æˆ·æ¶ˆæ¯
  addMessage(text, "user");
  chatInput.value = "";
  chatInput.disabled = true;
  sendBtn.disabled = true;
  sendBtn.textContent = "å‘é€ä¸­...";
  
  // æ˜¾ç¤ºæ€è€ƒä¸­çŠ¶æ€
  const thinkingMsg = addMessage("", "assistant", "thinking");
  
  try {
    console.log("å‘é€è¯·æ±‚åˆ°:", WEBHOOK_URL);
    console.log("å‘é€å†…å®¹:", { input: text });
    
    const res = await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ input: text })  // å…³é”®ï¼šä½¿ç”¨ input å­—æ®µ
    });
    
    console.log("å“åº”çŠ¶æ€ç :", res.status);
    
    if (!res.ok) {
      throw new Error(`HTTPé”™è¯¯ ${res.status}`);
    }
    
    const responseText = await res.text();
    console.log("åŸå§‹å“åº”æ–‡æœ¬:", responseText);
    
    let data;
    try {
      data = JSON.parse(responseText);
      console.log("è§£æåçš„JSONæ•°æ®:", data);
    } catch (e) {
      console.warn("å“åº”ä¸æ˜¯JSONæ ¼å¼:", responseText);
      // å¦‚æœä¸æ˜¯JSONï¼Œç›´æ¥ä½¿ç”¨æ–‡æœ¬
      updateMessage(thinkingMsg, responseText, "assistant");
      return;
    }
    
    // å°è¯•å¤šç§å¯èƒ½çš„å­—æ®µå
    const answer = data.output || data.answer || data.reply || 
                   data.response || data.result || data.text || 
                   data.content || data.data;
    
    console.log("æå–çš„ç­”æ¡ˆ:", answer);
    
    if (answer) {
      updateMessage(thinkingMsg, answer, "assistant");
    } else {
      console.error("æœªæ‰¾åˆ°æœ‰æ•ˆå­—æ®µï¼Œå®Œæ•´æ•°æ®:", data);
      updateMessage(thinkingMsg, "æŠ±æ­‰ï¼Œæˆ‘æš‚æ—¶æ— æ³•å›ç­”è¿™ä¸ªé—®é¢˜ã€‚", "assistant");
    }
    
  } catch (error) {
    console.error("è¯·æ±‚å¤±è´¥:", error);
    updateMessage(thinkingMsg, `ç½‘ç»œè¯·æ±‚å¤±è´¥: ${error.message}`, "error");
  } finally {
    // æ¢å¤UIçŠ¶æ€
    chatInput.disabled = false;
    sendBtn.disabled = false;
    sendBtn.textContent = "å‘é€";
    chatInput.focus();
  }
}

// æŒ‰é’®ç‚¹å‡»å‘é€
sendBtn.addEventListener("click", sendMessage);

// å›è½¦å‘é€
chatInput.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !chatInput.disabled) {
    sendMessage();
  }
});

// é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæ¬¢è¿ä¿¡æ¯
window.addEventListener("DOMContentLoaded", async () => {
  try {
    // å¯é€‰ï¼šå‘é€ä¸€ä¸ªæµ‹è¯•è¯·æ±‚æ£€æŸ¥è¿æ¥
    console.log("æ£€æŸ¥Webhookè¿æ¥...");
    const testRes = await fetch(WEBHOOK_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ input: "ä½ å¥½" })
    });
    
    if (testRes.ok) {
      console.log("Webhookè¿æ¥æ­£å¸¸");
    } else {
      console.warn("Webhookè¿æ¥æµ‹è¯•å¤±è´¥:", testRes.status);
    }
  } catch (e) {
    console.warn("Webhookè¿æ¥æµ‹è¯•å¼‚å¸¸ï¼Œå¯å¿½ç•¥:", e.message);
  }
  
  // èšç„¦è¾“å…¥æ¡†
  chatInput.focus();
});
</script>
</body>
</html>
